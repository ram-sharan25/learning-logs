---
// Theme toggle component
---

<button
  class="theme-toggle p-2 rounded hover:bg-solarized-base02 transition-colors border-none"
  aria-label="Toggle theme"
  title="Toggle light/dark theme"
>
  <!-- Light bulb icon -->
  <svg
    class="w-5 h-5 fill-current text-solarized-base0 hover:text-solarized-blue transition-colors"
    viewBox="0 0 24 24"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M12 2C8.13 2 5 5.13 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6C7.8 12.16 7 10.63 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1zM12 22c.55 0 1-.45 1-1h-2c0 .55.45 1 1 1zm-3-3h6v-1H9v1z"
    ></path>
  </svg>
</button>

<script>
  // Theme management
  const themeToggles = document.querySelectorAll('.theme-toggle');
  const htmlElement = document.documentElement;

  // Get theme from localStorage or default to dark
  function getTheme() {
    const stored = localStorage.getItem('theme');
    return stored || 'dark';
  }

  // Set theme
  function setTheme(theme: string) {
    if (theme === 'light') {
      htmlElement.setAttribute('data-theme', 'light');
    } else {
      htmlElement.removeAttribute('data-theme');
    }
    localStorage.setItem('theme', theme);
  }

  // Toggle theme
  function toggleTheme() {
    const currentTheme = getTheme();
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    setTheme(newTheme);
  }

  // Initialize theme on page load
  setTheme(getTheme());

  // Add click listener to all theme toggle buttons
  themeToggles.forEach(toggle => {
    toggle.addEventListener('click', toggleTheme);
  });

  // Handle page navigation (for Astro view transitions if enabled)
  document.addEventListener('astro:page-load', () => {
    setTheme(getTheme());

    // Re-attach listeners after page load
    const newToggles = document.querySelectorAll('.theme-toggle');
    newToggles.forEach(toggle => {
      toggle.addEventListener('click', toggleTheme);
    });
  });
</script>

<style>
  .theme-toggle {
    cursor: pointer;
  }

  .theme-toggle:hover {
    transform: scale(1.1);
  }

  /* Light theme adjustments */
  :root[data-theme='light'] .theme-toggle svg {
    color: var(--color-text-secondary);
  }

  :root[data-theme='light'] .theme-toggle:hover {
    background-color: var(--color-bg-secondary);
  }

  :root[data-theme='light'] .theme-toggle:hover svg {
    color: var(--color-accent);
  }
</style>
