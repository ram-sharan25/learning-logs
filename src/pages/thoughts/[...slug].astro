---
import { getCollection } from "astro:content";
import BaseLayout from "@layouts/BaseLayout.astro";

export async function getStaticPaths() {
  const thoughts = await getCollection("thoughts", ({ data }) => !data.draft);
  return thoughts.map((thought) => ({
    params: { slug: thought.slug },
    props: { thought },
  }));
}

const { thought } = Astro.props;
const { Content } = await thought.render();
---

<BaseLayout title={`${thought.data.title} - Ram Sharan Rimal`}>
  <article class="prose prose-invert max-w-none">
    <!-- Header -->
    <header class="mb-8">
      <h1 class="text-4xl font-bold mb-4 text-solarized-blue">
        {thought.data.title}
      </h1>
      <div class="flex items-center gap-4 text-sm text-solarized-base00">
        <time datetime={thought.data.date.toISOString()}>
          {
            thought.data.date.toLocaleDateString("en-US", {
              year: "numeric",
              month: "long",
              day: "numeric",
            })
          }
        </time>
        {
          thought.data.tags.length > 0 && (
            <div class="flex gap-2">
              {thought.data.tags.map((tag) => (
                <span class="px-2 py-1 bg-solarized-base02 border border-solarized-base01 rounded text-solarized-cyan">
                  #{tag}
                </span>
              ))}
            </div>
          )
        }
      </div>
    </header>

    <!-- Content -->
    <div class="text-solarized-base0 blog-content">
      <Content />
    </div>

    <!-- Back Link -->
    <footer class="mt-12 pt-8 border-t border-solarized-base02">
      <a
        href="/thoughts"
        class="text-solarized-blue hover:text-solarized-cyan transition-colors"
      >
        ‚Üê Back to all thoughts
      </a>
    </footer>
  </article>
</BaseLayout>
