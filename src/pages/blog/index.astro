---
import BaseLayout from '@layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog', ({ data }) => !data.draft);
const sortedPosts = allPosts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<BaseLayout title="Learning Logs">
  <div>
    <h1 class="text-2xl sm:text-3xl md:text-4xl font-bold mb-6 sm:mb-8">
      <span class="terminal-prompt"></span>Blog
    </h1>

    {sortedPosts.length === 0 ? (
      <p class="text-sm sm:text-base text-solarized-base00">No posts yet. Check back soon!</p>
    ) : (
      <div class="space-y-4 sm:space-y-5">
        {sortedPosts.map((post) => (
          <article>
            <a href={`/blog/${post.slug}`} class="group block">
              <div class="flex flex-col sm:flex-row sm:justify-between sm:items-baseline mb-1 gap-1 sm:gap-0">
                <h2 class="text-sm sm:text-base group-hover:text-solarized-blue transition-colors" style="color: var(--color-orange);">
                  {post.data.title}
                </h2>
                <time datetime={post.data.date.toISOString()} class="text-xs sm:text-sm text-solarized-base00 sm:ml-4 sm:whitespace-nowrap">
                  {post.data.date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                  }).replace(/\//g, '.')}
                </time>
              </div>
              {post.data.description && (
                <p class="text-xs sm:text-sm text-solarized-base00">
                  {post.data.description}
                </p>
              )}
            </a>
          </article>
        ))}
      </div>
    )}
  </div>
</BaseLayout>
